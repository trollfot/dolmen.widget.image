<div i18n:domain="dolmen"
     tal:attributes="id view/id;
		     class view/klass;
		     style view/style;
		     title view/title;
		     lang view/lang;
		     onclick view/onclick;
		     ondblclick view/ondblclick;
		     onmousedown view/onmousedown;
		     onmouseup view/onmouseup;
		     onmouseover view/onmouseover;
		     onmousemove view/onmousemove;
		     onmouseout view/onmouseout;
		     onkeypress view/onkeypress;
		     onkeydown view/onkeydown;
		     onkeyup view/onkeyup;
		     disabled view/disabled;
		     tabindex view/tabindex;
		     onfocus view/onfocus;
		     onblur view/onblur;
		     onchange view/onchange;
		     readonly view/readonly;
		     accesskey view/accesskey;
		     onselect view/onselect;"
     tal:define="download_url view/download_url;
		 exists python: view.value is not None;">

  <div class="image-widget-preview"
       tal:condition="python:exists and view.preview_url">
    <img src="" 
	 tal:attributes="src view/preview_url;
			 title view/filename;" />
  </div>

  <span tal:condition="python: exists and download_url">
    <a
	tal:content="view/filename"
	tal:attributes="href download_url"
	>Filename</a>
    <span class="discreet">
      &mdash;
      <span tal:define="sizekb view/file_size"
	    tal:condition="sizekb"
	    tal:replace="sizekb/display">100</span>
    </span>
  </span>
  <div tal:condition="view/allow_nochange" style="padding-top: 1em;">
    <input
	type="radio"
	value="nochange"
	checked="checked"
	class="noborder"
	tal:attributes="name string:${view/name}.nochange;
			id string:${view/id}-nochange;
			onclick string:document.getElementById('${view/id}-input').disabled=true;"
	/>

    <label tal:attributes="for string:${view/id}-nochange"
	   i18n:translate="file_keep">Keep existing file</label>
    <br />
    <input type="radio"
	   value="delete"
	   class="noborder"
	   tal:condition="python: exists and download_url"
	   tal:attributes="name string:${view/name}.nochange;
			   id string:${view/id}-delete;
			   onclick string:document.getElementById('${view/id}-input').disabled=true;"
            />
    <label
	tal:attributes="for string:${view/id}-delete"
	i18n:translate="file_keep">Delete existing file</label>
    <br />
    <input type="radio"
	   tal:attributes="name string:${view/name}.nochange;
			   id string:${view/id}-replace;
			   onclick string:document.getElementById('${view/id}-input').disabled=false;" />
    <label
	tal:attributes="for string:${view/id}-replace" i18n:translate="file_replace">Replace with new file</label>
  </div>
  <input type="file"
	 tal:attributes="id string:${view/id}-input;
			 name view/name;
			 size view/size;
			 maxlength view/maxlength;" />
  
  <script tal:condition="view/allow_nochange" type="text/javascript"
	  tal:content="string:document.getElementById('${view/id}-input').disabled=true;">
  </script>
</div>
